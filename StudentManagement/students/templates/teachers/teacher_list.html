{% extends 'base.html' %}
{% block content %}

<h2 class="mb-3">Teachers</h2>

{% if perms.students.add_teacher %}
<a href="{% url 'add_teacher' %}" class="btn btn-primary mb-3">Add Teacher</a>
{% endif %}

<table class="table table-bordered table-striped">
    <tr>
        <th>Name</th>
        <th>Email</th>
        <th>Subject</th>
        <th>Phone</th>
        <th>Actions</th>
    </tr>

    {% for t in teachers %}
    <tr>
        <td>{{ t.name }}</td>
        <td>{{ t.email }}</td>
        <td>{{ t.subject }}</td>
        <td>{{ t.phone }}</td>
        <td>

            {% if perms.students.change_teacher %}
            <a href="{% url 'edit_teacher' t.id %}" class="btn btn-warning btn-sm">
                Edit
            </a>
            {% endif %}

            {% if perms.students.delete_teacher %}
            <!-- Delete Button -->
            <button class="btn btn-danger btn-sm" data-bs-toggle="modal" data-bs-target="#deleteModal{{ t.id }}">
                Delete
            </button>

            <!-- Delete Modal -->
            <div class="modal fade" id="deleteModal{{ t.id }}" tabindex="-1" data-bs-backdrop="static">
                <div class="modal-dialog modal-dialog-centered">
                    <div class="modal-content">

                        <div class="modal-header">
                            <h5 class="modal-title">Confirm Delete</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                        </div>

                        <div class="modal-body">
                            Are you sure you want to delete
                            <strong>{{ t.name }}</strong>?
                        </div>

                        <div class="modal-footer">
                            <button class="btn btn-secondary" data-bs-dismiss="modal">
                                Cancel
                            </button>

                            <!-- POST delete -->
                            <form method="POST" action="{% url 'delete_teacher' t.id %}">
                                {% csrf_token %}
                                <button type="submit" class="btn btn-danger">
                                    Yes, Delete
                                </button>
                            </form>
                        </div>

                    </div>
                </div>
            </div>
            {% endif %}

        </td>
    </tr>
    {% empty %}
    <tr>
        <td colspan="5" class="text-center">
            No teachers found.
        </td>
    </tr>
    {% endfor %}
</table>

{% endblock %}